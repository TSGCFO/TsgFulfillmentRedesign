import{c as d,r as o,k as P,q as _,j as e,B as c}from"./index-6MCi8tWB.js";import{u as B}from"./useQuery-PVc7J4dA.js";import{u as b}from"./useMutation-CmulkAfZ.js";import{I as S}from"./input-BhXA57Mw.js";import{L as m}from"./label-D0riWtJ8.js";import{C as g,b as C,c as k,d as I,a as U}from"./card-D6qM5tgO.js";import{S as G,a as Q,b as V,c as W,d as Y}from"./select-CCPcufPO.js";import{I as J,b as j,d as X,u as Z,e as K,l as ee}from"./images-D6BJx4qK.js";import{T as se}from"./trash-2-DScdPx9A.js";import"./index-D6Ojy0Bj.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=d("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=d("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=d("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=d("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=d("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);function ue(){const[i,z]=o.useState("general"),[p,v]=o.useState(null),[h,u]=o.useState(""),[y,f]=o.useState(null),{toast:n}=P(),N=_(),{data:l,isLoading:q}=B({queryKey:["images",i],queryFn:()=>ee(i)}),x=b({mutationFn:async({file:s,category:a,fileName:t})=>Z(s,a,t),onSuccess:s=>{s.success?(n({title:"Upload Successful",description:"Image has been uploaded to Supabase storage."}),N.invalidateQueries({queryKey:["images"]}),v(null),u(""),f(null)):n({variant:"destructive",title:"Upload Failed",description:s.error||"Failed to upload image."})}}),w=b({mutationFn:K,onSuccess:s=>{s.success?(n({title:"Delete Successful",description:"Image has been removed from storage."}),N.invalidateQueries({queryKey:["images"]})):n({variant:"destructive",title:"Delete Failed",description:s.error||"Failed to delete image."})}}),O=s=>{var t;const a=(t=s.target.files)==null?void 0:t[0];if(a){v(a);const r=new Date().toISOString().slice(0,10),A=a.name.split(".")[0].toLowerCase().replace(/[^a-z0-9]/g,"-"),H=a.name.split(".").pop();u(`${i}-${A}-${r}.${H}`);const T=URL.createObjectURL(a);f(T)}},R=()=>{if(!p||!h){n({variant:"destructive",title:"Missing Information",description:"Please select a file and enter a filename."});return}x.mutate({file:p,category:i,fileName:h})},D=s=>{confirm("Are you sure you want to delete this image?")&&w.mutate(s)},L=s=>{const a=j(s);window.open(a,"_blank")},$=()=>Object.entries(X).filter(([s,a])=>a.startsWith(i+"/"));return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Image Management System"}),e.jsx("p",{className:"text-gray-600",children:"Centralized image management for your Supabase storage. Upload, organize, and manage images with SEO-friendly naming."})]}),e.jsxs(g,{children:[e.jsxs(C,{children:[e.jsxs(k,{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-5 w-5"}),"Upload New Image"]}),e.jsx(I,{children:"Upload images to your Supabase storage with automatic organization and SEO-friendly naming."})]}),e.jsxs(U,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"category",children:"Category"}),e.jsxs(G,{value:i,onValueChange:s=>z(s),children:[e.jsx(Q,{children:e.jsx(V,{})}),e.jsx(W,{children:Object.entries(J).map(([s,a])=>e.jsx(Y,{value:a,children:s.charAt(0).toUpperCase()+s.slice(1)},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"file",children:"Select Image"}),e.jsx(S,{id:"file",type:"file",accept:"image/*",onChange:O})]})]}),p&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"filename",children:"SEO-Friendly Filename"}),e.jsx(S,{id:"filename",value:h,onChange:s=>u(s.target.value),placeholder:"e.g., warehouse-interior-operations-2024.jpg"})]}),y&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Preview"}),e.jsx("img",{src:y,alt:"Upload preview",className:"max-w-xs h-32 object-cover rounded border"})]}),e.jsx(c,{onClick:R,disabled:x.isPending,className:"w-full md:w-auto",children:x.isPending?e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"h-4 w-4 mr-2 animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Upload Image"]})})]})]})]}),e.jsxs(g,{children:[e.jsxs(C,{children:[e.jsxs(k,{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-5 w-5"}),"Browse Images - ",i.charAt(0).toUpperCase()+i.slice(1)]}),e.jsx(I,{children:"View and manage images in the selected category."})]}),e.jsx(U,{children:q?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(M,{className:"h-6 w-6 animate-spin"}),e.jsx("span",{className:"ml-2",children:"Loading images..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Registered Images"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:$().map(([s,a])=>e.jsxs(g,{className:"overflow-hidden",children:[e.jsx("div",{className:"aspect-video bg-gray-100 flex items-center justify-center",children:e.jsx("img",{src:j(s),alt:s,className:"w-full h-full object-cover",onError:t=>{t.target.src="https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80"}})}),e.jsxs("div",{className:"p-3",children:[e.jsx("p",{className:"font-medium text-sm truncate",title:s,children:s}),e.jsx("p",{className:"text-xs text-gray-500 truncate",title:a,children:a}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(c,{size:"sm",variant:"outline",onClick:()=>L(s),children:e.jsx(F,{className:"h-3 w-3"})}),e.jsx(c,{size:"sm",variant:"outline",onClick:()=>{const t=j(s),r=document.createElement("a");r.href=t,r.download=s,r.click()},children:e.jsx(ae,{className:"h-3 w-3"})}),e.jsx(c,{size:"sm",variant:"destructive",onClick:()=>D(s),disabled:w.isPending,children:e.jsx(se,{className:"h-3 w-3"})})]})]})]},s))})]}),(l==null?void 0:l.success)&&l.images.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Storage Files"}),e.jsx("div",{className:"space-y-2",children:l.images.map(s=>{var a;return e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[(a=s.metadata)!=null&&a.size?`${Math.round(s.metadata.size/1024)} KB`:"Unknown size"," â€¢",s.updated_at?new Date(s.updated_at).toLocaleDateString():"Unknown date"]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(c,{size:"sm",variant:"outline",onClick:()=>{const t=`https://ahnneaclpkspcdtoqzkp.supabase.co/storage/v1/object/public/images/${i}/${s.name}`;window.open(t,"_blank")},children:e.jsx(F,{className:"h-3 w-3"})})})]},s.name)})})]}),(l==null?void 0:l.success)&&l.images.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No images found in this category. Upload some images to get started."})]})})]})]})}export{ue as default};
